name: Deploy and Restart Service

on:
  push:
    branches: [ master ]  # Only trigger on push to master (when PR is merged)

jobs:
  deploy:
    runs-on: self-hosted
    
    steps:
    - name: Pull latest code and restart service
      run: |
        cd /home/gabi/github/Discord-Brain-Rot
        git pull origin master
        sudo systemctl restart personalgreeter.service
        
    - name: Verify service is running
      run: |
        sleep 5
        sudo systemctl is-active --quiet personalgreeter.service && echo "Service is running" || exit 1 