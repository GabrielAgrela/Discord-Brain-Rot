name: Deploy to Server

on:
  push:
    branches: [ master ]

jobs:
  deploy:
    runs-on: self-hosted
    
    steps:
    - name: Debug - Check current directory
      run: |
        echo "Current directory: $(pwd)"
        echo "User: $(whoami)"
        echo "Home: $HOME"
        ls -la
        
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Deploy with Docker Compose
      run: |
        cp /app/.env .
        docker compose up --build -d